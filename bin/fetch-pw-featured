#!/usr/bin/env python

import sys
import re
import requests
from bs4 import BeautifulSoup

url = 'https://www.primewire.tf/filter?sort=Featured&type=movie&quality=DVD'
prefix = 'https://www.primewire.tf'
try:
  html = requests.get(url).text
except requests.exceptions.RequestException as err:
  raise SystemExit(err)
try:
  limit = int(sys.argv[1])
except:
  limit = 5

soup = BeautifulSoup(html, 'html.parser')
for div in soup.find_all('div', class_='index_item', limit=limit):
  link = div.find('a').get('href')
  img = div.find('img').get('src')
  title = div.find('h2').get_text()
  cats = div.find('div', class_='item_categories').get_text(' ', strip=True)
  imdb_title = re.sub('[()]', '', title).replace(' ', '+')
  imdb_link = 'https://www.imdb.com/find?q={search}'.format(search = imdb_title)
  parsed = '\n' + title.upper() + ' - ' + cats + '\n' + prefix + link + '\n' + imdb_link
  print(parsed)
